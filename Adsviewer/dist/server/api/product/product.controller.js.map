{"version":3,"sources":["../../../../server/api/product/product.controller.js"],"names":["_","require","Product","respondWithResult","res","statusCode","entity","status","json","patchUpdates","patches","jsonpatch","apply","err","reject","save","removeEntity","remove","then","end","handleEntityNotFound","handleError","send","exports","index","req","find","exec","catch","show","findById","params","id","create","body","upsert","_id","findOneAndUpdate","new","setDefaultsOnInsert","runValidators","patch","destroy"],"mappings":"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","file":"product.controller.js","sourcesContent":["/**\n * Using Rails-like standard naming convention for endpoints.\n * GET     /api/products              ->  index\n * POST    /api/products              ->  create\n * GET     /api/products/:id          ->  show\n * PUT     /api/products/:id          ->  upsert\n * PATCH   /api/products/:id          ->  patch\n * DELETE  /api/products/:id          ->  destroy\n */\n\n'use strict';\n\nvar _ = require('lodash');\nvar Product = require('./product.model');\n\nfunction respondWithResult(res, statusCode) {\n  statusCode = statusCode || 200;\n  return function(entity) {\n    if(entity) {\n      return res.status(statusCode).json(entity);\n    }\n    return null;\n  };\n}\n\nfunction patchUpdates(patches) {\n  return function(entity) {\n    try {\n      jsonpatch.apply(entity, patches, /*validate*/ true);\n    } catch(err) {\n      return Promise.reject(err);\n    }\n\n    return entity.save();\n  };\n}\n\nfunction removeEntity(res) {\n  return function(entity) {\n    if(entity) {\n      return entity.remove()\n        .then(() => {\n          res.status(204).end();\n        });\n    }\n  };\n}\n\nfunction handleEntityNotFound(res) {\n  return function(entity) {\n    if(!entity) {\n      res.status(404).end();\n      return null;\n    }\n    return entity;\n  };\n}\n\nfunction handleError(res, statusCode) {\n  statusCode = statusCode || 500;\n  return function(err) {\n    res.status(statusCode).send(err);\n  };\n}\n\n// Gets a list of Products\nexports.index = function(req, res) {\n  return Product.find().exec()\n    .then(respondWithResult(res))\n    .catch(handleError(res));\n}\n\n// Gets a single Product from the DB\nexports.show = function(req, res) {\n  return Product.findById(req.params.id).exec()\n    .then(handleEntityNotFound(res))\n    .then(respondWithResult(res))\n    .catch(handleError(res));\n}\n\n// Creates a new Product in the DB\nexports.create = function(req, res) {\n  return Product.create(req.body)\n    .then(respondWithResult(res, 201))\n    .catch(handleError(res));\n}\n\n// Upserts the given Product in the DB at the specified ID\nexports.upsert = function(req, res) {\n  if(req.body._id) {\n    delete req.body._id;\n  }\n  return Product.findOneAndUpdate({_id: req.params.id}, req.body, {new: true, upsert: true, setDefaultsOnInsert: true, runValidators: true}).exec()\n\n    .then(respondWithResult(res))\n    .catch(handleError(res));\n}\n\n// Updates an existing Product in the DB\nexports.patch = function(req, res) {\n  if(req.body._id) {\n    delete req.body._id;\n  }\n  return Product.findById(req.params.id).exec()\n    .then(handleEntityNotFound(res))\n    .then(patchUpdates(req.body))\n    .then(respondWithResult(res))\n    .catch(handleError(res));\n}\n\n// Deletes a Product from the DB\nexports.destroy = function(req, res) {\n  return Product.findById(req.params.id).exec()\n    .then(handleEntityNotFound(res))\n    .then(removeEntity(res))\n    .catch(handleError(res));\n}\n"]}