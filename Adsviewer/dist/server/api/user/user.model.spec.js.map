{"version":3,"sources":["../../../../server/api/user/user.model.spec.js"],"names":["user","genUser","provider","name","email","password","describe","before","remove","beforeEach","afterEach","it","find","exec","should","eventually","have","length","save","then","userDup","be","rejected","undefined","authenticate","true","not","u"],"mappings":"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","file":"user.model.spec.js","sourcesContent":["'use strict';\n\nimport app from '../..';\nimport User from './user.model';\nvar user;\nvar genUser = function() {\n  user = new User({\n    provider: 'local',\n    name: 'Fake User',\n    email: 'test@example.com',\n    password: 'password'\n  });\n  return user;\n};\n\ndescribe('User Model', function() {\n  before(function() {\n    // Clear users before testing\n    return User.remove();\n  });\n\n  beforeEach(function() {\n    genUser();\n  });\n\n  afterEach(function() {\n    return User.remove();\n  });\n\n  it('should begin with no users', function() {\n    return User.find({}).exec().should\n      .eventually.have.length(0);\n  });\n\n  it('should fail when saving a duplicate user', function() {\n    return user.save()\n      .then(function() {\n        var userDup = genUser();\n        return userDup.save();\n      }).should.be.rejected;\n  });\n\n  describe('#email', function() {\n    it('should fail when saving with a blank email', function() {\n      user.email = '';\n      return user.save().should.be.rejected;\n    });\n\n    it('should fail when saving with a null email', function() {\n      user.email = null;\n      return user.save().should.be.rejected;\n    });\n\n    it('should fail when saving without an email', function() {\n      user.email = undefined;\n      return user.save().should.be.rejected;\n    });\n  });\n\n  describe('#password', function() {\n    it('should fail when saving with a blank password', function() {\n      user.password = '';\n      return user.save().should.be.rejected;\n    });\n\n    it('should fail when saving with a null password', function() {\n      user.password = null;\n      return user.save().should.be.rejected;\n    });\n\n    it('should fail when saving without a password', function() {\n      user.password = undefined;\n      return user.save().should.be.rejected;\n    });\n\n    describe('given the user has been previously saved', function() {\n      beforeEach(function() {\n        return user.save();\n      });\n\n      it('should authenticate user if valid', function() {\n        user.authenticate('password').should.be.true;\n      });\n\n      it('should not authenticate user if invalid', function() {\n        user.authenticate('blah').should.not.be.true;\n      });\n\n      it('should remain the same hash unless the password is updated', function() {\n        user.name = 'Test User';\n        return user.save()\n          .then(function(u) {\n            return u.authenticate('password');\n          }).should.eventually.be.true;\n      });\n    });\n  });\n\n});\n"]}