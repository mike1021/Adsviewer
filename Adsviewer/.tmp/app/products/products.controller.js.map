{"version":3,"sources":["../../../client/app/products/products.controller.js"],"names":["ProductsComponent","$http","$scope","Auth","$mdDialog","$mdMedia","filepicker","getCurrentUser","files","performUpload","customFullscreen","status","filter","get","success","data","products","originalProducts","error","err","console","log","product","title","name","Modal","show","api","columns","cols","that","dt1","Date","utcDate","newproduct","updated","uid","post","push","index","delete","_id","splice","edit","put","resetEventos","eventos","evento","Product","update","id","$promise","then","toastr","errors","Object","keys","message","save","b","active","statusText","angular","module","component","templateUrl","controller","config","filepickerProvider","setKey"],"mappings":";AACA;;;;;;AACA,CAAC,YAAU;AAAA,MAELA,iBAFK;AAGT;AACA,+BAAYC,KAAZ,EAAmBC,MAAnB,EAA2BC,IAA3B,EAAiCC,SAAjC,EAA4CC,QAA5C,EAAsDC,UAAtD,EAAkE;AAAA;;AAEhE,WAAKJ,MAAL,GAAcA,MAAd;AACA,WAAKD,KAAL,GAAaA,KAAb;AACA,WAAKE,IAAL,GAAYA,IAAZ;AACA,WAAKC,SAAL,GAAiBA,SAAjB;AACA,WAAKC,QAAL,GAAeA,QAAf;AACA,WAAKE,cAAL,GAAsBJ,KAAKI,cAA3B;AACAL,aAAOM,KAAP,GAAe,EAAf;AAEAN,aAAOO,aAAP,GAAuB,KAAvB;AACAP,aAAOQ,gBAAP,GAA0BL,SAAS,IAAT,KAAkBA,SAAS,IAAT,CAA5C;AACAH,aAAOS,MAAP,GAAgB,IAAhB;AACAT,aAAOU,MAAP,GAAc,MAAd;AACCX,YAAMY,GAAN,CAAU,eAAV,EACEC,OADF,CACU,UAASC,IAAT,EAAe;AACtBb,eAAOc,QAAP,GAAkBD,IAAlB;AACAb,eAAOe,gBAAP,GAA0BF,IAA1B;AACA;AACD,OALF,EAMIG,KANJ,CAMU,UAASC,GAAT,EAAc;AACnBC,gBAAQC,GAAR,CAAY,6BAAZ,EAA2CF,GAA3C;AACD,OARJ;AASF;;AA3BQ;AAAA;AAAA,2BA4BJG,OA5BI,EA4BI;AACV,YAAIC,KAAJ,CAAW,IAAGD,QAAQE,IAAX,EAAgB;AAAED,kBAAQ,cAAcD,QAAQE,IAA9B;AAAoC,SAAtD,MAA2D;AAAED,kBAAQ,eAAR;AAAyB;AAChGE,cAAMC,IAAN,CAAWJ,OAAX,EAAmB,EAACC,OAAMA,KAAP,EAAcI,KAAI,SAAlB,EAA6BC,SAASC,IAAtC,EAAnB;AACH;AA/BQ;AAAA;AAAA,sCAgCM;AACbT,gBAAQC,GAAR,CAAY,gBAAZ;AACA,YAAIS,OAAK,IAAT;AACA,YAAIC,MAAM,IAAIC,IAAJ,EAAV;AACA,YAAIC,UAAUF,GAAd;AACAX,gBAAQC,GAAR,CAAYS,KAAKvB,cAAjB;AACA;AACAuB,aAAK5B,MAAL,CAAYgC,UAAZ,CAAuBC,OAAvB,GAAiCF,OAAjC;AACAH,aAAK5B,MAAL,CAAYgC,UAAZ,CAAuBE,GAAvB,GAA6BN,KAAKvB,cAAL,GAAsBiB,IAAnD;AACAM,aAAK7B,KAAL,CAAWoC,IAAX,CAAgB,eAAhB,EAAiCP,KAAK5B,MAAL,CAAYgC,UAA7C,EACCpB,OADD,CACS,YAAW;AAClBgB,eAAK5B,MAAL,CAAYc,QAAZ,CAAqBsB,IAArB,CAA0BR,KAAK5B,MAAL,CAAYgC,UAAtC;AACAJ,eAAK5B,MAAL,CAAYgC,UAAZ,GAAyB,EAAzB;AACD,SAJD,EAKChB,KALD,CAKO,UAASA,KAAT,EAAe;AACpBE,kBAAQC,GAAR,CAAY,OAAZ;AACD,SAPD;AAQD;AAjDQ;AAAA;AAAA,8BAkDFkB,KAlDE,EAkDK;AACV,YAAIT,OAAK,IAAT;AACA;AACCA,aAAK7B,KAAL,CAAWuC,MAAX,CAAkB,mBAAkBV,KAAK5B,MAAL,CAAYc,QAAZ,CAAqBuB,KAArB,EAA4BE,GAAhE,EACC3B,OADD,CACS,YAAU;AAClBgB,eAAK5B,MAAL,CAAYc,QAAZ,CAAqB0B,MAArB,CAA4BH,KAA5B,EAAkC,CAAlC;AACA,SAHD,EAICrB,KAJD,CAIO,UAASC,GAAT,EAAa;AACnBC,kBAAQC,GAAR,CAAY,OAAZ,EAAoBF,GAApB;AACA,SAND;AAOF;AA5DM;AAAA;AAAA,iCA6DEoB,KA7DF,EA6DQ;AACf,YAAIT,OAAK,IAAT;AACAA,aAAK5B,MAAL,CAAYc,QAAZ,CAAqBuB,KAArB,EAA4BI,IAA5B,GAAkC,CAACb,KAAK5B,MAAL,CAAYc,QAAZ,CAAqBuB,KAArB,EAA4BI,IAA/D;AACD;AAhEQ;AAAA;AAAA,mCAiEIJ,KAjEJ,EAiEU;AACjB,YAAIT,OAAK,IAAT;AACAA,aAAK7B,KAAL,CAAW2C,GAAX,CAAe,mBAAmBd,KAAK5B,MAAL,CAAYc,QAAZ,CAAqBuB,KAArB,EAA4BE,GAA9D,EAAmEX,KAAK5B,MAAL,CAAYc,QAAZ,CAAqBuB,KAArB,CAAnE,EACCzB,OADD,CACS,YAAW;AAClBgB,eAAK5B,MAAL,CAAYc,QAAZ,CAAqBuB,KAArB,EAA4BI,IAA5B,GAAmC,KAAnC;AACD,SAHD,EAICzB,KAJD,CAIO,UAASC,GAAT,EAAa;AAClBC,kBAAQC,GAAR,CAAY,OAAZ;AACD,SAND;AAOD;AA1EQ;AAAA;AAAA,8BA2EF;AACL,YAAIS,OAAO,IAAX;AACAA,aAAK5B,MAAL,CAAYc,QAAZ,GAAuBc,KAAK5B,MAAL,CAAYe,gBAAnC;AACAa,aAAK5B,MAAL,CAAYU,MAAZ,GAAqB,MAArB;AACD;AA/EQ;AAAA;AAAA,sCAgFOY,IAhFP,EAgFY;AACnB,YAAIM,OAAK,IAAT;AACAA,aAAKe,YAAL;AACAf,aAAK5B,MAAL,CAAY4C,OAAZ,GAAsBhB,KAAK5B,MAAL,CAAY4C,OAAZ,CAAoBlC,MAApB,CAA2B,UAASmC,MAAT,EAAgB;AAC/D,iBAAOA,OAAOvB,IAAP,KAAgBA,IAAvB;AACD,SAFqB,CAAtB;AAGAM,aAAK5B,MAAL,CAAYU,MAAZ,GAAqB,aAAYY,IAAjC;AACD;AAvFQ;AAAA;AAAA,2BAwFJF,OAxFI,EAwFI;AACT,YAAG,SAASA,OAAZ,EAAoB;AAChB0B,kBAAQC,MAAR,CAAe,EAAEC,IAAGhD,OAAOoB,OAAP,CAAemB,GAApB,EAAf,EAA0CvC,OAAOoB,OAAjD,EAA0D6B,QAA1D,CAAmEC,IAAnE,CAAwE,YAAW;AACjFC,mBAAOvC,OAAP,CAAe,iCAAf,EAAiD,SAAjD;AACD,WAFD,EAEG,UAASI,KAAT,EAAgB;AAAE;AACnB,gBAAIC,MAAMD,MAAMH,IAAN,CAAWuC,MAArB;AACAD,mBAAOnC,KAAP,CAAaC,IAAIoC,OAAOC,IAAP,CAAYrC,GAAZ,CAAJ,EAAsBsC,OAAnC,EAA2CtC,IAAIoC,OAAOC,IAAP,CAAYrC,GAAZ,CAAJ,EAAsBK,IAAjE;AACD,WALD;AAMD,SAPH,MAQM;AACFwB,kBAAQU,IAAR,CAAaxD,OAAOoB,OAApB,EAA6B6B,QAA7B,CAAsCC,IAAtC,CAA2C,YAAW;AACpDC,mBAAOvC,OAAP,CAAe,iCAAf,EAAiD,SAAjD;AACD,WAFD,EAEG,UAASI,KAAT,EAAgB;AAAE;AACjB,gBAAIC,MAAMD,MAAMH,IAAN,CAAWuC,MAArB;AACAD,mBAAOnC,KAAP,CAAaC,IAAIoC,OAAOC,IAAP,CAAYrC,GAAZ,CAAJ,EAAsBsC,OAAnC,EAA2CtC,IAAIoC,OAAOC,IAAP,CAAYrC,GAAZ,CAAJ,EAAsBK,IAAjE;AACH,WALD;AAMD;AACJ;AAzGM;AAAA;AAAA,mCA0GMmC,CA1GN,EA0GQ;AAAE;AACfA,UAAEC,MAAF,GAAW,CAACD,EAAEC,MAAd;AACAZ,gBAAQC,MAAR,CAAe,EAAEC,IAAGS,EAAElB,GAAP,EAAf,EAA6BkB,CAA7B,EAAgCR,QAAhC,CAAyCC,IAAzC,CAA8C,YAAW,CAExD,CAFD,EAEG,UAASlC,KAAT,EAAgB;AAAE;AACjB;AACAmC,iBAAOnC,KAAP,CAAaA,MAAM2C,UAAN,GAAmB,IAAnB,GAA2B3C,MAAMP,MAAjC,GAA0C,GAAvD;AACAgD,YAAEC,MAAF,GAAW,CAACD,EAAEC,MAAd;AACH,SAND;AAOD;AAnHM;;AAAA;AAAA;;AAyHTE,UAAQC,MAAR,CAAe,cAAf,EACCC,SADD,CACW,UADX,EACuB;AACrBC,iBAAa,4BADQ;AAErBC,gBAAYlE;AAFS,GADvB,EAKCmE,MALD,CAKQ,UAAUC,kBAAV,EAA6B;AACnCA,uBAAmBC,MAAnB,CAA0B,wBAA1B;AACD,GAPD,EAOG;AAEJ,CAlID","file":"products.controller.js","sourcesContent":["\r\n'use strict';\r\n(function(){\r\n\r\nclass ProductsComponent {\r\n  //static $inject = ['$http','$scope','$mdDialog','filepicker','$mdMedia'];\r\n  constructor($http, $scope, Auth, $mdDialog, $mdMedia, filepicker) {\r\n    \r\n    this.$scope = $scope;\r\n    this.$http = $http;\r\n    this.Auth = Auth;\r\n    this.$mdDialog = $mdDialog;\r\n    this.$mdMedia= $mdMedia;\r\n    this.getCurrentUser = Auth.getCurrentUser;\r\n    $scope.files = {\r\n    };\r\n    $scope.performUpload = false;\r\n    $scope.customFullscreen = $mdMedia('xs') || $mdMedia('sm');\r\n    $scope.status = '  ';\r\n    $scope.filter='none';\r\n     $http.get('/api/products')\r\n      .success(function(data) {\r\n        $scope.products = data;\r\n        $scope.originalProducts = data;\r\n        //console.log($scope.eventos);\r\n      })\r\n        .error(function(err) {\r\n          console.log('Error! Problema de conexi√≥n', err);\r\n        });\r\n  }\r\n  edit(product){\r\n     var title; if(product.name){ title = 'Editando ' + product.name;} else{ title = 'Agregar nuevo';}\r\n      Modal.show(product,{title:title, api:'Product', columns: cols});\r\n  }\r\n  addNewProduct(){\r\n    console.log('prueba agregar');\r\n    var that=this;\r\n    var dt1 = new Date();\r\n    var utcDate = dt1;\r\n    console.log(that.getCurrentUser);\r\n    //var currentUser =that.getCurrentUser;\r\n    that.$scope.newproduct.updated = utcDate;\r\n    that.$scope.newproduct.uid = that.getCurrentUser().name;\r\n    that.$http.post('/api/products', that.$scope.newproduct)\r\n    .success(function (){\r\n      that.$scope.products.push(that.$scope.newproduct);\r\n      that.$scope.newproduct = {};\r\n    })\r\n    .error(function(error){\r\n      console.log('Error');\r\n    }); \r\n  }\r\n  delete(index) {\r\n      var that=this;\r\n      //console.log(banner);\r\n       that.$http.delete('/api/products/'+ that.$scope.products[index]._id)\r\n       .success(function(){\r\n        that.$scope.products.splice(index,1);\r\n       })\r\n       .error(function(err){\r\n        console.log('Error',err);\r\n       });\r\n    }\r\n  toggleEdit(index){\r\n    var that=this;\r\n    that.$scope.products[index].edit= !that.$scope.products[index].edit;\r\n  }\r\n  saveProducts(index){\r\n    var that=this;\r\n    that.$http.put('/api/products/' + that.$scope.products[index]._id, that.$scope.products[index])\r\n    .success(function() {\r\n      that.$scope.products[index].edit = false;\r\n    })\r\n    .error(function(err){\r\n      console.log('Error');\r\n    });\r\n  }\r\n  reset(){\r\n    var that = this;\r\n    that.$scope.products = that.$scope.originalProducts;\r\n    that.$scope.filter = 'none';\r\n  }\r\n  filterByEventos(name){\r\n    var that=this;\r\n    that.resetEventos();\r\n    that.$scope.eventos = that.$scope.eventos.filter(function(evento){\r\n      return evento.name === name;\r\n    });\r\n    that.$scope.filter = 'Nombre: '+ name; \r\n  }\r\n  save(product){\r\n      if('_id' in product){\r\n          Product.update({ id:$scope.product._id }, $scope.product).$promise.then(function() {\r\n            toastr.success(\"Product info saved successfully\",\"Success\");\r\n          }, function(error) { // error handler\r\n            var err = error.data.errors;\r\n            toastr.error(err[Object.keys(err)].message,err[Object.keys(err)].name);\r\n          });\r\n        }\r\n        else{\r\n          Product.save($scope.product).$promise.then(function() {\r\n            toastr.success(\"Product info saved successfully\",\"Success\");\r\n          }, function(error) { // error handler\r\n              var err = error.data.errors;\r\n              toastr.error(err[Object.keys(err)].message,err[Object.keys(err)].name);\r\n          });\r\n        }\r\n    }\r\n    changeActive(b){ // success handler\r\n      b.active = !b.active;\r\n      Product.update({ id:b._id }, b).$promise.then(function() {\r\n\r\n      }, function(error) { // error handler\r\n          // console.log(error);\r\n          toastr.error(error.statusText + ' (' +  error.status + ')');\r\n          b.active = !b.active;\r\n      });\r\n    }\r\n\r\n \r\n \r\n}\r\n\r\n  angular.module('adsviewerApp')\r\n  .component('products', {\r\n    templateUrl: 'app/products/products.html',\r\n    controller: ProductsComponent\r\n  })\r\n  .config(function (filepickerProvider){\r\n    filepickerProvider.setKey('AZby333WhT5Wkm6tWskTOz');\r\n  });;\r\n\r\n})();\r\n"]}