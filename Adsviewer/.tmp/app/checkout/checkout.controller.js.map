{"version":3,"sources":["../../../client/app/checkout/checkout.controller.js"],"names":["CheckoutComponent","$http","$scope","Auth","ngCart","getCurrentUser","cart","cartera","files","console","log","dt1","Date","utcDate","product","getItems","Total","getSubTotal","subTotal","iva","cotizacionDate","orderID","that","name","title","Modal","show","api","columns","cols","newproduct","updated","uid","post","success","products","push","error","index","delete","_id","splice","err","edit","put","originalProducts","filter","resetEventos","eventos","evento","Product","update","id","$promise","then","toastr","data","errors","Object","keys","message","save","b","active","statusText","status","angular","module","component","templateUrl","controller"],"mappings":"AAAA;;;;;;AACA,CAAC,YAAU;AAAA,MAELA,iBAFK;AAGT;AACA,+BAAYC,KAAZ,EAAmBC,MAAnB,EAA2BC,IAA3B,EAAiCC,MAAjC,EAAyC;AAAA;;AAEvC,WAAKF,MAAL,GAAcA,MAAd;AACA,WAAKD,KAAL,GAAaA,KAAb;AACA,WAAKE,IAAL,GAAYA,IAAZ;AACA,WAAKE,cAAL,GAAsBF,KAAKE,cAA3B;AACA;AACA;AACA;AACA,UAAIC,OAAOF,MAAX,CATuC,CASrB;AAClB,UAAIG,UAAS,EAAb;AACAL,aAAOM,KAAP,GAAe,EAAf;AAEDC,cAAQC,GAAR,CAAYJ,IAAZ;AACAJ,aAAOI,IAAP,GAAcA,IAAd;;AAEE;;;;;;;;;AASF;;AA7BQ;AAAA;AAAA,4BA8BJ;AACH,YAAIK,MAAM,IAAIC,IAAJ,EAAV;AACA,YAAIC,UAAUF,GAAd;AACAJ,gBAAQO,OAAR,GAAkBR,KAAKS,QAAL,EAAlB;AACAR,gBAAQS,KAAR,GAAgBV,KAAKW,WAAL,KAAmB,IAAnC;AACAV,gBAAQW,QAAR,GAAmBZ,KAAKW,WAAL,EAAnB;AACAV,gBAAQY,GAAR,GAAcb,KAAKW,WAAL,KAAmB,GAAjC;AACAV,gBAAQa,cAAR,GAAyBP,OAAzB;AACAN,gBAAQc,OAAR,GAAkBC,KAAKjB,cAAL,GAAsBkB,IAAxC;AAED;AAxCQ;AAAA;AAAA,2BAyCJT,OAzCI,EAyCI;AACV,YAAIU,KAAJ,CAAW,IAAGV,QAAQS,IAAX,EAAgB;AAAEC,kBAAQ,cAAcV,QAAQS,IAA9B;AAAoC,SAAtD,MAA2D;AAAEC,kBAAQ,eAAR;AAAyB;AAChGC,cAAMC,IAAN,CAAWZ,OAAX,EAAmB,EAACU,OAAMA,KAAP,EAAcG,KAAI,SAAlB,EAA6BC,SAASC,IAAtC,EAAnB;AACH;AA5CQ;AAAA;AAAA,sCA6CM;AACbpB,gBAAQC,GAAR,CAAY,gBAAZ;AACA,YAAIY,OAAK,IAAT;AACA,YAAIX,MAAM,IAAIC,IAAJ,EAAV;AACA,YAAIC,UAAUF,GAAd;AACAF,gBAAQC,GAAR,CAAYY,KAAKjB,cAAjB;AACA;AACAiB,aAAKpB,MAAL,CAAY4B,UAAZ,CAAuBC,OAAvB,GAAiClB,OAAjC;AACAS,aAAKpB,MAAL,CAAY4B,UAAZ,CAAuBE,GAAvB,GAA6BV,KAAKjB,cAAL,GAAsBkB,IAAnD;AACAD,aAAKrB,KAAL,CAAWgC,IAAX,CAAgB,eAAhB,EAAiCX,KAAKpB,MAAL,CAAY4B,UAA7C,EACCI,OADD,CACS,YAAW;AAClBZ,eAAKpB,MAAL,CAAYiC,QAAZ,CAAqBC,IAArB,CAA0Bd,KAAKpB,MAAL,CAAY4B,UAAtC;AACAR,eAAKpB,MAAL,CAAY4B,UAAZ,GAAyB,EAAzB;AACD,SAJD,EAKCO,KALD,CAKO,UAASA,KAAT,EAAe;AACpB5B,kBAAQC,GAAR,CAAY,OAAZ;AACD,SAPD;AAQD;AA9DQ;AAAA;AAAA,8BA+DF4B,KA/DE,EA+DK;AACV,YAAIhB,OAAK,IAAT;AACA;AACCA,aAAKrB,KAAL,CAAWsC,MAAX,CAAkB,mBAAkBjB,KAAKpB,MAAL,CAAYiC,QAAZ,CAAqBG,KAArB,EAA4BE,GAAhE,EACCN,OADD,CACS,YAAU;AAClBZ,eAAKpB,MAAL,CAAYiC,QAAZ,CAAqBM,MAArB,CAA4BH,KAA5B,EAAkC,CAAlC;AACA,SAHD,EAICD,KAJD,CAIO,UAASK,GAAT,EAAa;AACnBjC,kBAAQC,GAAR,CAAY,OAAZ,EAAoBgC,GAApB;AACA,SAND;AAOF;AAzEM;AAAA;AAAA,iCA0EEJ,KA1EF,EA0EQ;AACf,YAAIhB,OAAK,IAAT;AACAA,aAAKpB,MAAL,CAAYiC,QAAZ,CAAqBG,KAArB,EAA4BK,IAA5B,GAAkC,CAACrB,KAAKpB,MAAL,CAAYiC,QAAZ,CAAqBG,KAArB,EAA4BK,IAA/D;AACD;AA7EQ;AAAA;AAAA,mCA8EIL,KA9EJ,EA8EU;AACjB,YAAIhB,OAAK,IAAT;AACAA,aAAKrB,KAAL,CAAW2C,GAAX,CAAe,mBAAmBtB,KAAKpB,MAAL,CAAYiC,QAAZ,CAAqBG,KAArB,EAA4BE,GAA9D,EAAmElB,KAAKpB,MAAL,CAAYiC,QAAZ,CAAqBG,KAArB,CAAnE,EACCJ,OADD,CACS,YAAW;AAClBZ,eAAKpB,MAAL,CAAYiC,QAAZ,CAAqBG,KAArB,EAA4BK,IAA5B,GAAmC,KAAnC;AACD,SAHD,EAICN,KAJD,CAIO,UAASK,GAAT,EAAa;AAClBjC,kBAAQC,GAAR,CAAY,OAAZ;AACD,SAND;AAOD;AAvFQ;AAAA;AAAA,8BAwFF;AACL,YAAIY,OAAO,IAAX;AACAA,aAAKpB,MAAL,CAAYiC,QAAZ,GAAuBb,KAAKpB,MAAL,CAAY2C,gBAAnC;AACAvB,aAAKpB,MAAL,CAAY4C,MAAZ,GAAqB,MAArB;AACD;AA5FQ;AAAA;AAAA,sCA6FOvB,IA7FP,EA6FY;AACnB,YAAID,OAAK,IAAT;AACAA,aAAKyB,YAAL;AACAzB,aAAKpB,MAAL,CAAY8C,OAAZ,GAAsB1B,KAAKpB,MAAL,CAAY8C,OAAZ,CAAoBF,MAApB,CAA2B,UAASG,MAAT,EAAgB;AAC/D,iBAAOA,OAAO1B,IAAP,KAAgBA,IAAvB;AACD,SAFqB,CAAtB;AAGAD,aAAKpB,MAAL,CAAY4C,MAAZ,GAAqB,aAAYvB,IAAjC;AACD;AApGQ;AAAA;AAAA,2BAqGJT,OArGI,EAqGI;AACT,YAAG,SAASA,OAAZ,EAAoB;AAChBoC,kBAAQC,MAAR,CAAe,EAAEC,IAAGlD,OAAOY,OAAP,CAAe0B,GAApB,EAAf,EAA0CtC,OAAOY,OAAjD,EAA0DuC,QAA1D,CAAmEC,IAAnE,CAAwE,YAAW;AACjFC,mBAAOrB,OAAP,CAAe,iCAAf,EAAiD,SAAjD;AACD,WAFD,EAEG,UAASG,KAAT,EAAgB;AAAE;AACnB,gBAAIK,MAAML,MAAMmB,IAAN,CAAWC,MAArB;AACAF,mBAAOlB,KAAP,CAAaK,IAAIgB,OAAOC,IAAP,CAAYjB,GAAZ,CAAJ,EAAsBkB,OAAnC,EAA2ClB,IAAIgB,OAAOC,IAAP,CAAYjB,GAAZ,CAAJ,EAAsBnB,IAAjE;AACD,WALD;AAMD,SAPH,MAQM;AACF2B,kBAAQW,IAAR,CAAa3D,OAAOY,OAApB,EAA6BuC,QAA7B,CAAsCC,IAAtC,CAA2C,YAAW;AACpDC,mBAAOrB,OAAP,CAAe,iCAAf,EAAiD,SAAjD;AACD,WAFD,EAEG,UAASG,KAAT,EAAgB;AAAE;AACjB,gBAAIK,MAAML,MAAMmB,IAAN,CAAWC,MAArB;AACAF,mBAAOlB,KAAP,CAAaK,IAAIgB,OAAOC,IAAP,CAAYjB,GAAZ,CAAJ,EAAsBkB,OAAnC,EAA2ClB,IAAIgB,OAAOC,IAAP,CAAYjB,GAAZ,CAAJ,EAAsBnB,IAAjE;AACH,WALD;AAMD;AACJ;AAtHM;AAAA;AAAA,mCAuHMuC,CAvHN,EAuHQ;AAAE;AACfA,UAAEC,MAAF,GAAW,CAACD,EAAEC,MAAd;AACAb,gBAAQC,MAAR,CAAe,EAAEC,IAAGU,EAAEtB,GAAP,EAAf,EAA6BsB,CAA7B,EAAgCT,QAAhC,CAAyCC,IAAzC,CAA8C,YAAW,CAExD,CAFD,EAEG,UAASjB,KAAT,EAAgB;AAAE;AACjB;AACAkB,iBAAOlB,KAAP,CAAaA,MAAM2B,UAAN,GAAmB,IAAnB,GAA2B3B,MAAM4B,MAAjC,GAA0C,GAAvD;AACAH,YAAEC,MAAF,GAAW,CAACD,EAAEC,MAAd;AACH,SAND;AAOD;AAhIM;;AAAA;AAAA;;AAsITG,UAAQC,MAAR,CAAe,cAAf,EACCC,SADD,CACW,UADX,EACuB;AACrBC,iBAAa,4BADQ;AAErBC,gBAAYtE;AAFS,GADvB;AAMD,CA5ID","file":"checkout.controller.js","sourcesContent":["'use strict';\r\n(function(){\r\n\r\nclass CheckoutComponent {\r\n  //static $inject = ['$http','$scope','$mdDialog','filepicker','$mdMedia'];\r\n  constructor($http, $scope, Auth, ngCart) {\r\n    \r\n    this.$scope = $scope;\r\n    this.$http = $http;\r\n    this.Auth = Auth;\r\n    this.getCurrentUser = Auth.getCurrentUser;\r\n    //cart = ngCart;\r\n    //this.cart = ngCart;\r\n    //this.ngCart = ngCart.$cart;\r\n    var cart = ngCart;//.$cart;\r\n    var cartera =[];\r\n    $scope.files = {\r\n    };\r\n   console.log(cart);\r\n   $scope.cart = cart;\r\n\r\n     /*$http.get('/api/products')\r\n      .success(function(data) {\r\n        $scope.products = data;\r\n        $scope.originalProducts = data;\r\n        //console.log($scope.eventos);\r\n      })\r\n        .error(function(err) {\r\n          console.log('Error! Problema de conexi√≥n', err);\r\n        });*/\r\n  }\r\n  add(){\r\n    var dt1 = new Date();\r\n    var utcDate = dt1;\r\n    cartera.product = cart.getItems();\r\n    cartera.Total = cart.getSubTotal()*1.16;\r\n    cartera.subTotal = cart.getSubTotal();\r\n    cartera.iva = cart.getSubTotal()*.16;\r\n    cartera.cotizacionDate = utcDate;\r\n    cartera.orderID = that.getCurrentUser().name;\r\n  \r\n  }\r\n  edit(product){\r\n     var title; if(product.name){ title = 'Editando ' + product.name;} else{ title = 'Agregar nuevo';}\r\n      Modal.show(product,{title:title, api:'Product', columns: cols});\r\n  }\r\n  addNewProduct(){\r\n    console.log('prueba agregar');\r\n    var that=this;\r\n    var dt1 = new Date();\r\n    var utcDate = dt1;\r\n    console.log(that.getCurrentUser);\r\n    //var currentUser =that.getCurrentUser;\r\n    that.$scope.newproduct.updated = utcDate;\r\n    that.$scope.newproduct.uid = that.getCurrentUser().name;\r\n    that.$http.post('/api/products', that.$scope.newproduct)\r\n    .success(function (){\r\n      that.$scope.products.push(that.$scope.newproduct);\r\n      that.$scope.newproduct = {};\r\n    })\r\n    .error(function(error){\r\n      console.log('Error');\r\n    }); \r\n  }\r\n  delete(index) {\r\n      var that=this;\r\n      //console.log(banner);\r\n       that.$http.delete('/api/products/'+ that.$scope.products[index]._id)\r\n       .success(function(){\r\n        that.$scope.products.splice(index,1);\r\n       })\r\n       .error(function(err){\r\n        console.log('Error',err);\r\n       });\r\n    }\r\n  toggleEdit(index){\r\n    var that=this;\r\n    that.$scope.products[index].edit= !that.$scope.products[index].edit;\r\n  }\r\n  saveProducts(index){\r\n    var that=this;\r\n    that.$http.put('/api/products/' + that.$scope.products[index]._id, that.$scope.products[index])\r\n    .success(function() {\r\n      that.$scope.products[index].edit = false;\r\n    })\r\n    .error(function(err){\r\n      console.log('Error');\r\n    });\r\n  }\r\n  reset(){\r\n    var that = this;\r\n    that.$scope.products = that.$scope.originalProducts;\r\n    that.$scope.filter = 'none';\r\n  }\r\n  filterByEventos(name){\r\n    var that=this;\r\n    that.resetEventos();\r\n    that.$scope.eventos = that.$scope.eventos.filter(function(evento){\r\n      return evento.name === name;\r\n    });\r\n    that.$scope.filter = 'Nombre: '+ name; \r\n  }\r\n  save(product){\r\n      if('_id' in product){\r\n          Product.update({ id:$scope.product._id }, $scope.product).$promise.then(function() {\r\n            toastr.success(\"Product info saved successfully\",\"Success\");\r\n          }, function(error) { // error handler\r\n            var err = error.data.errors;\r\n            toastr.error(err[Object.keys(err)].message,err[Object.keys(err)].name);\r\n          });\r\n        }\r\n        else{\r\n          Product.save($scope.product).$promise.then(function() {\r\n            toastr.success(\"Product info saved successfully\",\"Success\");\r\n          }, function(error) { // error handler\r\n              var err = error.data.errors;\r\n              toastr.error(err[Object.keys(err)].message,err[Object.keys(err)].name);\r\n          });\r\n        }\r\n    }\r\n    changeActive(b){ // success handler\r\n      b.active = !b.active;\r\n      Product.update({ id:b._id }, b).$promise.then(function() {\r\n\r\n      }, function(error) { // error handler\r\n          // console.log(error);\r\n          toastr.error(error.statusText + ' (' +  error.status + ')');\r\n          b.active = !b.active;\r\n      });\r\n    }\r\n\r\n \r\n \r\n}\r\n\r\n  angular.module('adsviewerApp')\r\n  .component('checkout', {\r\n    templateUrl: 'app/checkout/checkout.html',\r\n    controller: CheckoutComponent\r\n  });\r\n\r\n})();\r\n"]}