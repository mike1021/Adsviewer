{"version":3,"sources":["../../../client/app/checkout/checkout.controller.js"],"names":["CheckoutComponent","$http","$scope","Auth","ngCart","getCurrentUser","cart","cartera","files","console","log","dt1","Date","utcDate","product","getItems","Total","getSubTotal","subTotal","iva","cotizacionDate","orderID","that","name","nombrecliente","mail","emailcliente","post","success","error","title","Modal","show","api","columns","cols","newproduct","updated","uid","products","push","index","delete","_id","splice","err","edit","put","originalProducts","filter","resetEventos","eventos","evento","Product","update","id","$promise","then","toastr","data","errors","Object","keys","message","save","b","active","statusText","status","angular","module","component","templateUrl","controller"],"mappings":"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","file":"checkout.controller.js","sourcesContent":["'use strict';\r\n(function(){\r\n\r\nclass CheckoutComponent {\r\n  //static $inject = ['$http','$scope','$mdDialog','filepicker','$mdMedia'];\r\n  constructor($http, $scope, Auth, ngCart) {\r\n    \r\n    this.$scope = $scope;\r\n    this.$http = $http;\r\n    this.Auth = Auth;\r\n    this.getCurrentUser = Auth.getCurrentUser;\r\n    //cart = ngCart;\r\n    //this.cart = ngCart;\r\n    //this.ngCart = ngCart.$cart;\r\n    var cart = ngCart;//.$cart;\r\n    var cartera =[];\r\n    $scope.files = {\r\n    };\r\n   console.log(cart);\r\n   $scope.cart = cart;\r\n\r\n     /*$http.get('/api/products')\r\n      .success(function(data) {\r\n        $scope.products = data;\r\n        $scope.originalProducts = data;\r\n        //console.log($scope.eventos);\r\n      })\r\n        .error(function(err) {\r\n          console.log('Error! Problema de conexi√≥n', err);\r\n        });*/\r\n  }\r\n  add(){\r\n    var dt1 = new Date();\r\n    var utcDate = dt1;\r\n    cartera.product = cart.getItems();\r\n    cartera.Total = cart.getSubTotal()*1.16;\r\n    cartera.subTotal = cart.getSubTotal();\r\n    cartera.iva = cart.getSubTotal()*.16;\r\n    cartera.cotizacionDate = utcDate;\r\n    cartera.orderID = that.getCurrentUser().name;\r\n    cartera.name = cartera.nombrecliente;\r\n    cartera.mail = cartera.emailcliente;\r\n    that.$http.post('/api/cotizaciones', cartera)\r\n    .success(function(){\r\n        cartera=[];\r\n        cart\r\n    })\r\n    .error(function(error){\r\n      console.log('Error');\r\n    })\r\n\r\n  }\r\n  edit(product){\r\n     var title; if(product.name){ title = 'Editando ' + product.name;} else{ title = 'Agregar nuevo';}\r\n      Modal.show(product,{title:title, api:'Product', columns: cols});\r\n  }\r\n  addNewProduct(){\r\n    console.log('prueba agregar');\r\n    var that=this;\r\n    var dt1 = new Date();\r\n    var utcDate = dt1;\r\n    console.log(that.getCurrentUser);\r\n    //var currentUser =that.getCurrentUser;\r\n    that.$scope.newproduct.updated = utcDate;\r\n    that.$scope.newproduct.uid = that.getCurrentUser().name;\r\n    that.$http.post('/api/products', that.$scope.newproduct)\r\n    .success(function (){\r\n      that.$scope.products.push(that.$scope.newproduct);\r\n      that.$scope.newproduct = {};\r\n    })\r\n    .error(function(error){\r\n      console.log('Error');\r\n    }); \r\n  }\r\n  delete(index) {\r\n      var that=this;\r\n      //console.log(banner);\r\n       that.$http.delete('/api/products/'+ that.$scope.products[index]._id)\r\n       .success(function(){\r\n        that.$scope.products.splice(index,1);\r\n       })\r\n       .error(function(err){\r\n        console.log('Error',err);\r\n       });\r\n    }\r\n  toggleEdit(index){\r\n    var that=this;\r\n    that.$scope.products[index].edit= !that.$scope.products[index].edit;\r\n  }\r\n  saveProducts(index){\r\n    var that=this;\r\n    that.$http.put('/api/products/' + that.$scope.products[index]._id, that.$scope.products[index])\r\n    .success(function() {\r\n      that.$scope.products[index].edit = false;\r\n    })\r\n    .error(function(err){\r\n      console.log('Error');\r\n    });\r\n  }\r\n  reset(){\r\n    var that = this;\r\n    that.$scope.products = that.$scope.originalProducts;\r\n    that.$scope.filter = 'none';\r\n  }\r\n  filterByEventos(name){\r\n    var that=this;\r\n    that.resetEventos();\r\n    that.$scope.eventos = that.$scope.eventos.filter(function(evento){\r\n      return evento.name === name;\r\n    });\r\n    that.$scope.filter = 'Nombre: '+ name; \r\n  }\r\n  save(product){\r\n      if('_id' in product){\r\n          Product.update({ id:$scope.product._id }, $scope.product).$promise.then(function() {\r\n            toastr.success(\"Product info saved successfully\",\"Success\");\r\n          }, function(error) { // error handler\r\n            var err = error.data.errors;\r\n            toastr.error(err[Object.keys(err)].message,err[Object.keys(err)].name);\r\n          });\r\n        }\r\n        else{\r\n          Product.save($scope.product).$promise.then(function() {\r\n            toastr.success(\"Product info saved successfully\",\"Success\");\r\n          }, function(error) { // error handler\r\n              var err = error.data.errors;\r\n              toastr.error(err[Object.keys(err)].message,err[Object.keys(err)].name);\r\n          });\r\n        }\r\n    }\r\n    changeActive(b){ // success handler\r\n      b.active = !b.active;\r\n      Product.update({ id:b._id }, b).$promise.then(function() {\r\n\r\n      }, function(error) { // error handler\r\n          // console.log(error);\r\n          toastr.error(error.statusText + ' (' +  error.status + ')');\r\n          b.active = !b.active;\r\n      });\r\n    }\r\n\r\n \r\n \r\n}\r\n\r\n  angular.module('adsviewerApp')\r\n  .component('checkout', {\r\n    templateUrl: 'app/checkout/checkout.html',\r\n    controller: CheckoutComponent\r\n  });\r\n\r\n})();\r\n"]}